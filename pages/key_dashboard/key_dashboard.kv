#:kivy 2.1.0

<KeyDashboardScreen>:
    BoxLayout:
        orientation: "vertical"

        Header:
            size_hint_y: None
            height: dp(64)

        BoxLayout:
            size_hint_y: None
            height: dp(48)
            padding: dp(16), 0

            Button:
                text: "Back"
                size_hint_x: None
                width: dp(100)
                background_normal: ""
                background_color: 0, 0, 0, 0
                color: 0.9, 0.95, 1, 1
                on_release: root.go_back()

            Widget:

        FloatLayout:
            size_hint_y: 1

            GradientBackground:
                pos: self.pos
                size: self.size

            BoxLayout:
                orientation: "vertical"
                size_hint: 0.9, 0.9
                pos_hint: {"center_x": .5, "center_y": .5}
                padding: dp(16)
                spacing: dp(12)

                Label:
                    text: "KEY AUTHORIZATION\nDASHBOARD"
                    font_size: "24sp"
                    bold: True
                    halign: "center"
                    valign: "middle"
                    text_size: self.width, None
                    size_hint_y: None
                    height: self.texture_size[1] + dp(12)

                ScrollView:
                    GridLayout:
                        id: key_grid
                        cols: 1
                        spacing: dp(8)
                        padding: dp(6)
                        size_hint_y: None
                        height: self.minimum_height

        # ================= LOADING OVERLAY =================
        FloatLayout:
            opacity: 1 if root.is_loading else 0
            disabled: not root.is_loading

            canvas.before:
                Color:
                    rgba: 0, 0, 0, .6
                Rectangle:
                    pos: self.pos
                    size: self.size

            BoxLayout:
                orientation: "vertical"
                size_hint: None, None
                size: dp(260), dp(160)
                pos_hint: {"center_x": .5, "center_y": .5}
                spacing: dp(16)
                padding: dp(20)

                canvas.before:
                    Color:
                        rgba: .06, .12, .22, 1
                    RoundedRectangle:
                        radius: [16]
                        pos: self.pos
                        size: self.size

                Spinner:
                    active: True
                    size_hint: None, None
                    size: dp(48), dp(48)

                Label:
                    text: "Initializing Key System..."
                    color: .9, .95, 1, 1
                    halign: "center"
                    valign: "middle"
                    text_size: self.size

        Footer:
            size_hint_y: None
            height: dp(48)
            version: "12.9.3"


<KeyItem>:
    size_hint_y: None
    height: dp(56)
    padding: dp(16), 0
    spacing: dp(10)

    canvas.before:
        Color:
            rgba: .05, .12, .24, 1
        RoundedRectangle:
            radius: [14]
            pos: self.pos
            size: self.size

    Label:
        text: root.key_name
        color: .9, .95, 1, 1
        halign: "left"
        valign: "middle"
        text_size: self.size

    BoxLayout:
        size_hint_x: None
        width: dp(110)
        spacing: dp(8)

        Widget:
            size_hint_x: None
            width: dp(20)
            canvas:
                Color:
                    rgba: root.status_color
                Ellipse:
                    pos: self.center_x - dp(8), self.center_y - dp(8)
                    size: dp(16), dp(16)

        Label:
            text: root.status
            color: root.status_color
            valign: "middle"
            text_size: self.size
