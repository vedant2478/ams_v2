<ActivityCodeScreen@BaseScreen>:
    name: "activity_code"

    FloatLayout:

        # ===== Header =====
        Header:
            pos_hint: {"top": 1}
        BoxLayout:
            orientation: "horizontal"
            size_hint_y: None
            height: "48dp"
            padding: "16dp", 0
            pos_hint: {"top": .95}

            Button:
                text: "Home"
                size_hint_x: None
                width: "100dp"
                background_normal: ""
                background_color: 0, 0, 0, 0   # fully transparent
                color: 0.90, 0.95, 1, 1
                font_size: "16sp"
                on_release: root.go_back()

            Widget:
        # ===== Main Content =====
        BoxLayout:
            orientation: "vertical"
            spacing: "26dp"
            size_hint: None, None
            size: "520dp", "720dp"
            pos_hint: {"center_x": 0.5, "center_y": 0.55}

            # ---- Title ----
            Label:
                text: "Activity Code Entry"
                font_size: "24sp"
                color: 0.9, 0.95, 1, 1
                size_hint_y: None
                height: "40dp"
                halign: "center"
                valign: "middle"
                text_size: self.size

            # ---- Code Dots ----
            BoxLayout:
                orientation: "horizontal"
                spacing: "18dp"
                size_hint: None, None
                height: "32dp"
                width: self.minimum_width
                pos_hint: {"center_x": 0.5}

                Widget:
                    size_hint: None, None
                    size: "16dp", "16dp"
                    canvas:
                        Color:
                            rgba: (1,1,1,0.9) if root.code_length >= 1 else (1,1,1,0.25)
                        Ellipse:
                            pos: self.pos
                            size: self.size

                Widget:
                    size_hint: None, None
                    size: "16dp", "16dp"
                    canvas:
                        Color:
                            rgba: (1,1,1,0.9) if root.code_length >= 2 else (1,1,1,0.25)
                        Ellipse:
                            pos: self.pos
                            size: self.size

            # ---- Status Message ----
            Label:
                text: root.message
                font_size: "16sp"
                color: (1, 0.3, 0.3, 1) if root.message else (1,1,1,0)
                size_hint_y: None
                height: "30dp"
                halign: "center"
                valign: "middle"
                text_size: self.size

            Widget:
                size_hint_y: None
                height: "12dp"

            # ---- Divider ----
            Widget:
                size_hint_y: None
                height: "1dp"
                canvas:
                    Color:
                        rgba: 1,1,1,0.25
                    Rectangle:
                        pos: self.pos
                        size: self.size

            Widget:
                size_hint_y: None
                height: "20dp"

            # ---- Keypad ----
            Keypad:
                callback: root.on_keypad
                size_hint: None, None
                size: "520dp", "460dp"
                pos_hint: {"center_x": 0.5}

        # ===== Footer =====
        Footer:
            pos_hint: {"y": 0}
            version_text: "Version: 12.9.3"
